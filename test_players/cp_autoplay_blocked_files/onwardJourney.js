/*
 *  Copyright 2011 Twitter, Inc.
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */

// http://paulirish.com/2011/requestanimationframe-for-smart-animating/
// http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
// requestAnimationFrame polyfill by Erik MÃ¶ller. fixes from Paul Irish and Tino Zijdel
// MIT license

define("utils/languageMappings",[],function(){"use strict";return{map:function(e){var t=e,n={"en-GB":"en","en-gb":"en","cy-GB":"cy","cy-gb":"cy","gd-GB":"gd","gd-gb":"gd","ga-GB":"ga","ga-gb":"ga","ru-uk":"ru",zh:"zh-hans","sr-latn":"sr"};return n[e]&&(t=n[e]),t}}}),define("utils/eventbus",[],function(){"use strict";var e={};return{addEventListener:function(t,n,o){e[t]||(e[t]=[]),e[t].push(n)},dispatch:function(t,n){if(void 0!==e[t])for(var o=0;o<e[t].length;o++)e[t][o](n)},DISMISS_CP:"DISMISS_CP",CAROUSEL_ITEM_CLICK:"CAROUSEL_ITEM_CLICK",COUNTDOWN_COMPLETE:"COUNTDOWN_COMPLETE",COUNTDOWN_CLICK:"COUNTDOWN_CLICK",SHOW_SMP_SCRUBBAR:"SHOW_SMP_SCRUBBAR",HIDE_SMP_SCRUBBAR:"HIDE_SMP_SCRUBBAR",COUNTDOWN_SKIPPED:"COUNTDOWN_SKIPPED",CAROUSEL_DRAGGED:"CAROUSEL_DRAGGED",NEXT_ITEM_PANEL_WIDTH:"NEXT_ITEM_PANEL_WIDTH",COUNTDOWN_STARTED:"COUNTDOWN_STARTED",CLOSE_BUTTON_CLICKED:"CLOSE_BUTTON_CLICKED",CAROUSEL_REQUIRES_UPDATED_ARIA:"CAROUSEL_REQUIRES_UPDATED_ARIA",ON_DEMAND_CAROUSEL_BUTTON_CLICK:"ON_DEMAND_CAROUSEL_BUTTON_CLICK",DISMISS_CLICK_FROM_NEXT_ITEM_PANEL:"DISMISS_CLICK_FROM_NEXT_ITEM_PANEL"}}),define("model/statsConstants",[],function(){"use strict";return{CP_STATS:"continuousPlay.stats",CP_PLAY:"continuousPlay.play",CP_STATS_OPEN_CAROUSEL:"openMoreVideos",CP_STATS_CLOSE_CAROUSEL:"closeMoreVideos",CP_STATS_DISMISS_CONT_PLAY:"dismissContPlay",CP_PLAY_VIDEO_COUNTDOWN_COMPLETE:"auto",CP_PLAY_VIDEO_COUNTDOWN_CLICKED:"cta",CP_PLAY_VIDEO_CAROUSEL_CLICKED:"carousel",CP_PLAY_VIDEO_REPLAY:"replay",CP_STATS_TURN_CP_ON:"turnCPon",CP_STATS_TURN_CP_OFF:"turnCPoff",AP_SONAR:"SonarUserActionEvent",AP_STATS_DISMISS_CONT_PLAY:"autoPlayPlugin_dismiss",AP_PLAY_VIDEO_COUNTDOWN_COMPLETE:"autoPlayPlugin_play_after_countdown_complete",AP_PLAY_VIDEO_COUNTDOWN_CLICKED:"autoPlayPlugin_play_after_nextItem_click",AP_PLAY_VIDEO_REPLAY:"autoPlayPlugin_replay",AP_STATS_TURN_AP_ON:"autoPlayPlugin_turn_ON",AP_STATS_TURN_AP_OFF:"autoPlayPlugin_turn_OFF",AP_STATS_COUNTDOWN_SKIPPED:"autoPlayPlugin_countdown_skipped",AP_PLAY_VIDEO_CAROUSEL_CLICKED:"carousel",AP_ON_DEMAND_CAROUSEL_BUTTON_CLICK:"autoPlayPlugin_on_demand_carousel_button_click",AP_DISMISS_CLICK_FROM_NEXT_ITEM_PANEL:"autoPlayPlugin_dismiss_from_next_item_panel"}}),define("model/copy",[],function(){"use strict";var e={autoPlugUpNext:"Up next in...",autoPlugUpNextStopped:"Up next",autoPlugCancel:"Cancel",autoPlugPlay:"Play next item",autoPlugCloseCountdownAccessibilityText:"Dismiss autoplay panel",autoPlugAccessibilityLabelCountdown:"The next item {title} will play automatically. Press CONTROL + Q to cancel",autoPlugAccessibilityLabelCountdownTouchDevice:"The next item {title} will play automatically, press dismiss autoplay panel to cancel",autoPlugAccessibilityCountdownStopped:"You have cancelled autoplay",autoPlugON:"ON",autoPlugOFF:"OFF",autoPlugMoreContents:"More",autoPlugLive:"LIVE",autoPlugRightChevron:"More clips",autoPlugLeftChevron:"Previous clips",autoPlugPlayItemNumber:"Play item {number} of {total}",autoPlugDurationTime:"Duration {time}",autoPlugWatchMore:"Watch more",autoPlugMoreClips:"More clips",autoPlugMoreProgrammes:"More programmes",autoPlugShowMore:"Show more",autoPlugMoreVideos:"More videos"};return{update:function(){for(var t in window.Language)e.hasOwnProperty(t)&&(e[t]=window.Language[t])},translations:e}}),define("model/templates",[],function(){"use strict";var e={};!function(e,t){function n(e){return String(null===e||void 0===e?"":e)}function o(e){return e=n(e),u.test(e)?e.replace(i,"&amp;").replace(a,"&lt;").replace(l,"&gt;").replace(s,"&#39;").replace(r,"&quot;"):e}e.Template=function(e,t,n,o){this.r=e||this.r,this.c=n,this.options=o,this.text=t||"",this.buf=""},e.Template.prototype={r:function(e,t,n){return""},v:o,t:n,render:function(e,t,n){return this.ri([e],t||{},n)},ri:function(e,t,n){return this.r(e,t,n)},rp:function(e,t,n,o){var i=n[e];return i?(this.c&&"string"==typeof i&&(i=this.c.compile(i,this.options)),i.ri(t,n,o)):""},rs:function(e,t,n){var o=e[e.length-1];if(!c(o))return void n(e,t,this);for(var i=0;i<o.length;i++)e.push(o[i]),n(e,t,this),e.pop()},s:function(e,t,n,o,i,a,l){var s;return(!c(e)||0!==e.length)&&("function"==typeof e&&(e=this.ls(e,t,n,o,i,a,l)),s=""===e||!!e,!o&&s&&t&&t.push("object"==typeof e?e:t[t.length-1]),s)},d:function(e,t,n,o){var i=e.split("."),a=this.f(i[0],t,n,o),l=null;if("."===e&&c(t[t.length-2]))return t[t.length-1];for(var s=1;s<i.length;s++)a&&"object"==typeof a&&i[s]in a?(l=a,a=a[i[s]]):a="";return!(o&&!a)&&(o||"function"!=typeof a||(t.push(l),a=this.lv(a,t,n),t.pop()),a)},f:function(e,t,n,o){for(var i=!1,a=null,l=!1,s=t.length-1;s>=0;s--)if((a=t[s])&&"object"==typeof a&&e in a){i=a[e],l=!0;break}return l?(o||"function"!=typeof i||(i=this.lv(i,t,n)),i):!o&&""},ho:function(e,t,n,o,i){var a=this.c,l=this.options;l.delimiters=i;var o=e.call(t,o);return o=null==o?String(o):o.toString(),this.b(a.compile(o,l).render(t,n)),!1},b:function(e){this.buf+=e},fl:function(){var e=this.buf;return this.buf="",e},ls:function(e,t,n,o,i,a,l){var s=t[t.length-1],r=null;if(!o&&this.c&&e.length>0)return this.ho(e,s,n,this.text.substring(i,a),l);if("function"==typeof(r=e.call(s))){if(o)return!0;if(this.c)return this.ho(r,s,n,this.text.substring(i,a),l)}return r},lv:function(e,t,o){var i=t[t.length-1],a=e.call(i);return"function"==typeof a&&(a=n(a.call(i)),this.c&&~a.indexOf("{{"))?this.c.compile(a,this.options).render(i,o):n(a)}};var i=/&/g,a=/</g,l=/>/g,s=/\'/g,r=/\"/g,u=/[&<>\"\']/,c=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}("undefined"!=typeof exports?exports:e);var t={};return t.autoplayOnOffButton=new e.Template(function(e,t,n){var o=this;return o.b(n=n||""),o.b("<span class='somebg'></span>"),o.b("\n"+n),o.b("\n"+n),o.b('<div class="gcp_autoplayOnOffButtonDiv">'),o.b("\n"+n),o.b('\t<button href="#" class="gcp_autoplayOnOffButton" aria-label="'),o.b(o.v(o.f("accessibilityLabel",e,t,0))),o.b('">'),o.b("\n"+n),o.b("\t    "),o.b(o.v(o.f("title",e,t,0))),o.b("\n"+n),o.b("\t</button>"),o.b("\n"+n),o.b("</div>"),o.fl()}),t.carouselControls=new e.Template(function(e,t,n){var o=this;return o.b(n=n||""),o.b('<div class="gcp_carouselControlsButtons">'),o.b("\n"+n),o.b("\n"+n),o.b('    <button aria-label="'),o.b(o.v(o.f("closeButtonAccessibilityLabel",e,t,0))),o.b('" title="'),o.b(o.v(o.f("closeButtonAccessibilityLabel",e,t,0))),o.b('" class="gcp_panelsClose" tabindex="-1">'),o.b("\n"+n),o.b('        <svg class="gcp_closeSVG" focusable="false">'),o.b("\n"+n),o.b('            <use xlink:href="#close" width="100%" height="100%" />'),o.b("\n"+n),o.b("        </svg>"),o.b("\n"+n),o.b("    </button>"),o.b("\n"+n),o.b("\n"+n),o.b("\n"+n),o.b('    <button class="gcp_carouselControlsPrevious" aria-label="'),o.b(o.v(o.f("previousButtonAccessibilityLabel",e,t,0))),o.b('" title="'),o.b(o.v(o.f("previousButtonAccessibilityLabel",e,t,0))),o.b('" tabindex="-1">'),o.b("\n"+n),o.b('        <svg focusable="false">'),o.b("\n"+n),o.b('            <use xlink:href="#previous" width="100%" height="100%"/>'),o.b("\n"+n),o.b("        </svg>"),o.b("\n"+n),o.b("    </button>"),o.b("\n"+n),o.b('    <button class="gcp_carouselControlsNext gcp_inactive" aria-label="'),o.b(o.v(o.f("nextButtonAccessibilityLabel",e,t,0))),o.b('" title="'),o.b(o.v(o.f("nextButtonAccessibilityLabel",e,t,0))),o.b('" tabindex="-1">'),o.b("\n"+n),o.b('        <svg focusable="false">'),o.b("\n"+n),o.b('            <use xlink:href="#next" width="100%" height="100%"/>'),o.b("\n"+n),o.b("        </svg>"),o.b("\n"+n),o.b("    </button>"),o.b("\n"+n),o.b("    "),o.b("\n"+n),o.b("</div>"),o.fl()}),t.carouselItem=new e.Template(function(e,t,n){var o=this;return o.b(n=n||""),o.b("<"),o.b(o.v(o.f("buttonOrDiv",e,t,0))),o.b(" "),o.b(o.v(o.f("role",e,t,0))),o.b(' class="gcp_item" href="#">'),o.b("\n"+n),o.b('    <div class="gcp_itemContainer">'),o.b("\n"+n),o.b('        <div class="gcp_itemWrap">'),o.b("\n"+n),o.b('            <div class="gcp_itemCta">'),o.b("\n"+n),o.b('                <svg class="gcp_itemCtaIcon" focusable="false" tabindex="-1">'),o.b("\n"+n),o.b('                     <use xlink:href="#play" width="100%" height="100%" />'),o.b("\n"+n),o.b("                </svg>"),o.b("\n"+n),o.b('                <h4 class="gcp_itemDuration backgroundFadedOut" aria-label="'),o.b(o.v(o.f("durationAriaLabel",e,t,0))),o.b('">'),o.b(o.v(o.f("duration",e,t,0))),o.b("</h4>"),o.b("\n"+n),o.b("            </div>"),o.b("\n"+n),o.b('            <img src="'),o.b(o.v(o.f("holdingImageURL",e,t,0))),o.b('" class="gcp_itemImg" aria-hidden="true">'),o.b("\n"+n),o.b('            <div class="gcp_itemImgGradient"></div>'),o.b("\n"+n),o.b("        </div>"),o.b("\n"+n),o.b("\n"+n),o.b("        <div class=gcp_infoWrap>"),o.b("\n"+n),o.b('            <h3 class="gcp_itemTitle">'),o.b(o.v(o.f("title",e,t,0))),o.b("</h3>"),o.b("\n"+n),o.b('            <p class="gcp_itemDescription">'),o.b(o.v(o.f("description",e,t,0))),o.b("</p>"),o.b("\n"+n),o.b('            <div class="gcp_itemDateHolder">'),o.b("\n"+n),o.b('                <svg class="icon-clock" focusable="false">'),o.b("\n"+n),o.b('                    <use xlink:href="#duration-clock" width="100%" height="100%" />'),o.b("\n"+n),o.b("                </svg>"),o.b("\n"+n),o.b('                <h4 class="gcp_itemDate">'),o.b(o.v(o.f("date",e,t,0))),o.b("</h4>"),o.b("\n"+n),o.b("            </div>"),o.b("\n"+n),o.b("        </div>"),o.b("\n"+n),o.b("    </div>"),o.b("\n"+n),o.b("</"),o.b(o.v(o.f("buttonOrDiv",e,t,0))),o.b(">"),o.fl()}),t.countdownItem=new e.Template(function(e,t,n){var o=this;return o.b(n=n||""),o.b('<span class="gcp_countdownText">'),o.b(o.v(o.f("countdownText",e,t,0))),o.b("</span>"),o.b("\n"+n),o.b('<button aria-label="'),o.b(o.v(o.f("accessibilityLabel",e,t,0))),o.b('" title="'),o.b(o.v(o.f("accessibilityLabel",e,t,0))),o.b('" class="gcp_countdownClose">'),o.b("\n"+n),o.b('    <svg class="gcp_closeSVG">'),o.b("\n"+n),o.b('        <use xlink:href="#close" width="100%" height="100%" />'),o.b("\n"+n),o.b("    </svg>"),o.b("\n"+n),o.b("</button>"),o.fl()}),t.countdownSpinner=new e.Template(function(e,t,n){var o=this;return o.b(n=n||""),o.b('<div class="gcp_spinnerCountdownWrap">'),o.b("\n"+n),o.b("\n"+n),o.b('\t<div class="gcp_countdownNumber gcp_centerHelper">'),o.b("\n"+n),o.b("\t"),o.b("\n"+n),o.b('\t\t<button class="gcp_close_button gcp_centerHelper" tabindex="-1" >'),o.b("\n"+n),o.b('\t\t    <svg class="gcp_timerX" focusable="false" >'),o.b("\n"+n),o.b('\t        \t<use xlink:href="#close"/>'),o.b("\n"+n),o.b("\t    \t</svg>"),o.b("\n"+n),o.b("    \t</button>"),o.b("\n"+n),o.b("\n"+n),o.b('    \t<span class="gcp_timer">'),o.b(o.v(o.f("seconds",e,t,0))),o.b("</span>"),o.b("\n"+n),o.b("\n"+n),o.b("    </div>"),o.b("\n"+n),o.b("\n"+n),o.b('\t<button class="gcp_spinnerCountdown_button gcp_centerHelper" aria-label="'),o.b(o.v(o.f("accessibilityLabelCountdown",e,t,0))),o.b('" tabindex="-1">'),o.b("\n"+n),o.b("\n"+n),o.b('\t\t<svg class="gcp_svgSpinner" viewBox="0 0 100 100" focusable="false">'),o.b("\n"+n),o.b("\n"+n),o.b("\t        <path"),o.b("\n"+n),o.b('\t        \td="'),o.b(o.v(o.f("default_pathString",e,t,0))),o.b('"'),o.b("\n"+n),o.b('\t\t        stroke-width="6"'),o.b("\n"+n),o.b('\t\t        fillOpacity="0"'),o.b("\n"+n),o.b('\t\t        stroke-dasharray="'),o.b(o.v(o.f("fullCircleStrokeDasharray",e,t,0))),o.b('"'),o.b("\n"+n),o.b('\t\t        stroke="#7f7f7f"'),o.b("\n"+n),o.b('\t\t        fill="none" '),o.b("\n"+n),o.b("\t\t        >"),o.b("\n"+n),o.b("\t        </path>"),o.b("\n"+n),o.b("\n"+n),o.b("\t        <path"),o.b("\n"+n),o.b('\t        \tclass="gcp_circle_animation"'),o.b("\n"+n),o.b('\t        \td="'),o.b(o.v(o.f("default_pathString",e,t,0))),o.b('"\t\t        '),o.b("\n"+n),o.b('\t        \tstroke-width="6"'),o.b("\n"+n),o.b('\t\t        fillOpacity="0"'),o.b("\n"+n),o.b('\t\t        style="'),o.b(o.v(o.f("pathStyle",e,t,0))),o.b('"'),o.b("\n"+n),o.b('\t\t        stroke="'),o.b(o.v(o.f("strokeColour",e,t,0))),o.b('"'),o.b("\n"+n),o.b('\t\t        fill="none" >'),o.b("\n"+n),o.b("\t        </path>"),o.b("\n"+n),o.b("\n"+n),o.b("      </svg>"),o.b("\n"+n),o.b("\n"+n),o.b("\t</button>"),o.b("\n"+n),o.b("\n"+n),o.b('\t<div class="gcp_cancel" aria-label="'),o.b(o.v(o.f("cancel",e,t,0))),o.b('">'),o.b(o.v(o.f("cancel",e,t,0))),o.b("</div>"),o.b("\n"+n),o.b("\n"+n),o.b("</div>"),o.fl()}),t.icons=new e.Template(function(e,t,n){var o=this;return o.b(n=n||""),o.b('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display: none;">'),o.b("\n"+n),o.b("\n"+n),o.b('    <symbol id="close" viewBox="0 0 44 44">'),o.b("\n"+n),o.b('        <rect x="20.281" y="8.162" transform="matrix(0.7073 0.7069 -0.7069 0.7073 21.9906 -9.1127)" fill="#FFFFFF" style="fill: inherit" width="3.437" height="27.676"/>'),o.b("\n"+n),o.b('        <rect x="20.281" y="8.162" transform="matrix(0.7071 -0.7071 0.7071 0.7071 -9.1127 22)" fill="#FFFFFF" style="fill: inherit" width="3.437" height="27.675"/>'),o.b("\n"+n),o.b("    </symbol>"),o.b("\n"+n),o.b('    <symbol id="continuous-play" viewBox="0 0 44 44">'),o.b("\n"+n),o.b('            <path fill="#FFFFFF" style="fill: inherit" d="M27.5,11H11v16.5h16.5V11z M25.438,25.438H13.062V13.062h12.375V25.438z"/>'),o.b("\n"+n),o.b('            <polygon fill="#FFFFFF" style="fill: inherit" points="30.25,14.438 28.875,14.438 28.875,28.875 14.438,28.875 14.438,30.25 30.25,30.25 "/>'),o.b("\n"+n),o.b('            <polygon fill="#FFFFFF" style="fill: inherit" points="31.625,16.5 31.625,31.625 16.5,31.625 16.5,33 33,33 33,16.5 "/>'),o.b("\n"+n),o.b('            <polygon fill="#FFFFFF" style="fill: inherit" points="16.5,15.125 16.5,23.375 23.114,19.25 "/>'),o.b("\n"+n),o.b("    </symbol>"),o.b("\n"+n),o.b('    <symbol id="duration-clock" viewBox="0 0 25 25">'),o.b("\n"+n),o.b('        <path fill="#FFFFFF" style="fill: inherit" d="M12.5,6C8.91,6,6,8.909,6,12.5c0,3.59,2.91,6.5,6.5,6.5s6.5-2.91,6.5-6.5C19,8.909,16.09,6,12.5,6z M12.5,17.5 c-2.758,0-5-2.243-5-5c0-2.758,2.242-5,5-5c2.757,0,5,2.242,5,5C17.5,15.257,15.257,17.5,12.5,17.5z"/>'),o.b("\n"+n),o.b('        <polygon fill="#FFFFFF" style="fill: inherit" points="13,9.067 12,9.067 12,12.696 15.227,14.574 15.555,14.005 13,12.117"/>'),o.b("\n"+n),o.b("    </symbol>"),o.b("\n"+n),o.b('    <symbol id="play" viewBox="0 0 44 44">'),o.b("\n"+n),o.b('        <polygon fill="#FFFFFF" style="fill: inherit"  points="14.4,33 32.3,22 14.4,11"/>'),o.b("\n"+n),o.b("    </symbol>"),o.b("\n"+n),o.b('    <symbol id="replay" viewBox="0 0 44 44">'),o.b("\n"+n),o.b('        <path fill="#FFFFFF" style="fill: inherit" d="M28.188,23.719c0,3.602-2.93,6.531-6.531,6.531s-6.531-2.93-6.531-6.531c0-3.601,2.93-6.531,6.531-6.531'),o.b("\n"+n),o.b("\tc0.115,0,0.229-0.006,0.344,0v-2.75c-0.115-0.004-0.229,0-0.344,0c-5.126,0-9.281,4.156-9.281,9.281"),o.b("\n"+n),o.b("\tc0,5.126,4.155,9.281,9.281,9.281s9.281-4.155,9.281-9.281c0-0.116,0.004-0.228,0-0.344h-2.75"),o.b("\n"+n),o.b('\tC28.193,23.49,28.188,23.603,28.188,23.719"/>'),o.b("\n"+n),o.b('        <polygon fill="#FFFFFF" style="fill: inherit" points="23.375,11 23.375,20.625 31.625,15.812 "/>'),o.b("\n"+n),o.b("    </symbol>"),o.b("\n"+n),o.b('    <symbol id="next" viewBox="0 0 44 44">'),o.b("\n"+n),o.b('        <polygon points="35,22 9,6 9,13.2 23.6,22 9,30.8 9,38 "/>'),o.b("\n"+n),o.b("    </symbol>"),o.b("\n"+n),o.b('    <symbol id="previous" viewBox="0 0 44 44">'),o.b("\n"+n),o.b('        <polygon points="9,22 35,6 35,13.2 20.4,22 35,30.8 35,38 "/>'),o.b("\n"+n),o.b("    </symbol>"),o.b("\n"+n),o.b('    <symbol id="tick">'),o.b("\n"+n),o.b('        <polygon points="8.52434955 14.1394665 15.2404 6.13496161 13.8884821 5 8.3073933 11.6518491 5.13348571 8.99155223 4 10.3434701"></polygon>'),o.b("\n"+n),o.b("    </symbol>"),o.b("\n"+n),o.b("\n"+n),o.b("</svg>"),o.fl()}),t.onDemandButton=new e.Template(function(e,t,n){var o=this;return o.b(n=n||""),o.b('<button id="gcp_onDemandButtonContainer" aria-label="'),o.b(o.v(o.f("accessibilityLabel",e,t,0))),o.b('" title="'),o.b(o.v(o.f("accessibilityLabel",e,t,0))),o.b('">'),o.b("\n"+n),o.b("\t<p>"),o.b(o.v(o.f("buttonText",e,t,0))),o.b("</p>"),o.b("\n"+n),o.b("</button>"),o.fl()}),t.settingsPanel=new e.Template(function(e,t,n){var o=this;return o.b(n=n||""),o.b('<div class="gcp_border"></div>'),o.b("\n"+n),o.b("\n"+n),o.b('<div class="gcp_settingsPanelHeader">'),o.b("\n"+n),o.b('    <div class="gcp_settingsPanelBlock gcp_settingsPanelTitle">'),o.b(o.v(o.f("title",e,t,0))),o.b("</div>"),o.b("\n"+n),o.b("    "),o.b("\n"+n),o.b('        <button class="gcp_onOffSwitchToggleButtonWrap" href="#" aria-label="'),o.b(o.v(o.f("accessibilityLabel",e,t,0))),o.b('" title="'),o.b(o.v(o.f("accessibilityLabel",e,t,0))),o.b('">'),o.b("\n"+n),o.b("\n"+n),o.b('            <label class="gcp_toggle">'),o.b("\n"+n),o.b('                <input type="checkbox" class="gcp_onOffSwitchToggle" checked>'),o.b("\n"+n),o.b('                <span role="checkbox" class="gcp_toggleSlider round" style="background-color: '),o.b(o.v(o.f("productColour",e,t,0))),o.b('">'),o.b("\n"+n),o.b('                    <svg class="gcp_tick" style="fill:'),o.b(o.v(o.f("productColour",e,t,0))),o.b('" focusable="false">'),o.b("\n"+n),o.b('                        <use xlink:href="#tick" width="100%" height="100%" />'),o.b("\n"+n),o.b("                    </svg>"),o.b("\n"+n),o.b("                </span>"),o.b("\n"+n),o.b("            </label>"),o.b("\n"+n),o.b("\n"+n),o.b("        </button>"),o.b("\n"+n),o.b("\n"+n),o.b("    </div>"),o.b("\n"+n),o.b("\n"+n),o.b("</div>"),o.fl()}),t}),define("utils/cssTools",[],function(){"use strict";var e=function(e){n(e,"fadedOut","fadedIn"),e.style.pointerEvents="none"},t=function(e){n(e,"fadedIn","fadedOut"),e.style.pointerEvents="auto"},n=function(e,t,n){if(e){var o=e.className;if(""===o)return void(e.className=t);o=o.replace(new RegExp("\\b"+n+"\\b","g"),"").replace(new RegExp("\\b"+t+"\\b","g"),"")+" "+t,e.className=o.trim()}};return{fadeIn:t,fadeOut:e,addRemoveCSSclassToElement:n,hasClass:function(e,t){return!!e&&(" "+e.className+" ").indexOf(" "+t+" ")>-1}}}),define("model/config",[],function(){"use strict";return{PRODUCT_NAME:"",CONT_PLAY_DATA_KEY:"smp.plugin.continuousplay.playlistSetChanged",IS_IPHONE_OR_IPOD:!1,IS_TOUCH:!1,IS_IOS:!1,IS_IPHONE:!1,IOS_VERSION:null,IS_OLD_IPAD:!1,IS_WINDOWS:!1,IS_WIN7_IE11:!1,NEEDS_USER_TRIGGERED_FIRST_PLAY:!1,DEFAULT_COUNTDOWN_SECS:10,AD_PLUGIN_EXISTS:!1,PRETEND_PLAYLIST_HAS_ADS:!1,AUTOPLAY_FIRST_ITEM:!0,CP_ENABLED:!0,HAS_FOCUS_BUG:!1,SHOW_LIVE_OR_DURATION:!1,CAROUSEL_UPDATED:!1,STOP_ON_GUIDANCE:!1,FULLSCREEN_ONLY_CAROUSEL:!1,OPEN_CAROUSEL_BUTTON_LABEL:1}}),define("utils/playlistTools",["model/config","utils/cssTools"],function(e,t){"use strict";var n=function(e,t){for(var n=!1,o=0;o<e.items.length;o++){if(t==e.items[o].vpid){n=!0;break}if(t==e.items[o].versionID){n=!0;break}}return n};return{validateTheData:function(e,n){for(var o=[],i=0;i<e.items.length;i++){var a=e.items[i].playlist,l=a&&e.items[i].playlist.items.length>0;a&&l&&o.push(e.items[i])}return 0==o.length?t.addRemoveCSSclassToElement(n,"hideOnwardJourney",""):t.addRemoveCSSclassToElement(n,"","hideOnwardJourney"),o},checkForLoadedPlaylistURLorPIDinData:function(e,t){var o=-1;if(t.length>0)for(var i=0;i<t.length;i++){var a=t[i].playlist;if("string"==typeof a){if(e==a){o=i;break}}else if(n(a,e)){o=i;break}}return o},getFirstProgrammeItem:function(e){for(var t=0;t<e.items.length;t++){var n=e.items[t].kind;if(!n)return e.items[t];if("programme"==n||"radioProgramme"==n||"audio"==n||"360"==n)return e.items[t]}return""},mergeIntoPlaylist:function(e){function t(t,n){n?e[t]&&(e.playlist[n]=e[t],delete e[t]):e[t]&&(e.playlist[t]=e[t],delete e[t])}var n;for(n in e)if(e.hasOwnProperty(n)&&"playlist"!=n)switch(n){case"title":t("title");break;case"description":t("description","summary");break;case"imgUrl":t("imgUrl","holdingImageURL");break;case"date":t("date")}return!1!==e.playlist.allowContinuousCast&&(e.playlist.allowContinuousCast=!0),e.playlist},setLiveOrDuration:function(t,n,o){var i;if(t.showLiveOrDuration?e.SHOW_LIVE_OR_DURATION=t.showLiveOrDuration:(e.SHOW_LIVE_OR_DURATION=!1,i=""),e.SHOW_LIVE_OR_DURATION)for(var a=0;a<n.items.length;a++)"ident"!=n.items[a].kind&&"advert"!=n.items[a].kind&&(i=window.Utils.secondsToTime(n.items[a].duration)),n.items[a].live&&(i=o.autoPlugLive);return i},getVoiceReadersDuration:function(e,t){var n="";return""!==e&&(e!==t.autoPlugLive?(n=t.autoPlugDurationTime,n=n.replace("{time}",e)):n=t.autoPlugLive),n}}}),define("model/cpModel",["utils/playlistTools"],function(e){"use strict";var t=[],n="",o=-1,i=-1,a=null,l=function(e){t=e},s=function(){return t},r=function(e){return t[e]},u=function(e){o=e},c=function(){return t[o]},d=function(){return o},b=function(){return t[o+1]},f=function(){return o+1<t.length},g=function(e){a=e,n=p(e)},p=function(t){var n;if(t.url)n=t.url;else{var o=e.getFirstProgrammeItem(t);n=o.identifier?o.identifier:o.mediatorIdentifier}return n},m=function(){return n},_=function(){-1!=o&&(i=o),a=null,n="",o=-1,C.showingAds=!1,C.playlistLoading=!0},v=function(){return i},C={isFullscreen:!1,countdownRunning:!1,videoWidth:0,highlightColour:"#ff00ff",foreHighlightColour:"ffffff",showingAds:!1,settingsOpen:!1,tooSmallForContinuousPlay:!1,ctaIsShowing:!1,playlistLoading:!1,buttonsArray:[],windowWidth:0,nextItemPanelWidth:0,onDemandCarouselShown:!1,controlsAlwaysOriginalSetting:!1,previousActiveElement:null,enhanceBrightColoursContrast:!1};return{setItems:l,getItems:s,getItemAtIndex:r,getCurrentlyPlayingItem:c,getCurrentlyPlayingItemIndex:d,getNextPlayingItem:b,setLoadedPlaylist:g,getLoadedPlaylistURLorPID:m,resetForNewPlaylist:_,setCurrentlyPlayingIndex:u,hasMoreItemsToPlay:f,getJustPlayedIndex:v,getURLorPID:p,viewModel:C}}),define("utils/generalUtils",[],function(){"use strict";return{addHandlerToMultipleEvents:function(e,t,n,o){var i;o=!!o;for(var a=0;a<t.length;a++)i=t[a],e.addEventListener(i,n,o)}}}),define("utils/uiListener",[],function(){"use strict";return{add:function(e,t,n,o,i){var a=!1;!1!==i&&(i=!0),e.addEventListener("touchstart",function(e){a=!0,setTimeout(function(){a=!1},500)}),t&&e.addEventListener("click",function(n){return t.bind(e)(n,a)}),n&&(e.addEventListener("mouseenter",function(t){if(!a)return n.bind(e)(t,a)}),e.addEventListener("focus",function(t){if(!a)return n.bind(e)(t,a)}),i&&e.addEventListener("touchstart",function(t){return n.bind(e)(t,a)})),o&&(e.addEventListener("mouseleave",function(t){if(!a)return o.bind(e)(t,a)}),e.addEventListener("blur",function(t){return o.bind(e)(t,a)}),i&&document.addEventListener("touchend",function(t){return o.bind(e)(t,a)}))}}}),define("utils/requestAnimationFramePolyfill",[],function(){"use strict";!function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var o=(new Date).getTime(),i=Math.max(0,16-(o-e)),a=window.setTimeout(function(){t(o+i)},i);return e=o+i,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}()}),define("carousel/DraggableDiv",["model/templates","utils/cssTools","model/cpModel","utils/generalUtils","utils/uiListener","model/config","utils/eventbus","utils/requestAnimationFramePolyfill"],function(e,t,n,o,i,a,l,s){return function(){var o,s,r,u,c,d,b,f,g,p,m,_,v,C,h,y,E,P,S,I,A,w,T,L,O,D,N,R,M=0,U=!1,x=!1,F=0,k=!1,B=function(e){(U||f-g>20)&&e.preventDefault&&(e.preventDefault(),e.stopPropagation())},W=function(){return(new Date).getTime()},H=function(e){if(l.dispatch(l.CAROUSEL_TABBING),"Tab"===e.key&&1!=e.shiftKey){for(var t,o=document.activeElement,i=0;i<N.length;i++)N[i]===o&&(t=i);var a=o.getBoundingClientRect();D=n.viewModel.videoWidth-a.right,D<250&&(Z(),setTimeout(function(){t<N.length-1&&N[t+1].focus()},0))}},Y=function(e){if(cancelAnimationFrame(m),P=[],!U&&e){d=parseFloat(o.style.left)||0,b=parseFloat(o.style.top)||0;var t=e.changedTouches;t&&(e=t[0]),C=e.pageX,h=e.pageY,y=C,o.addEventListener("touchend",V),o.addEventListener("touchmove",G),o.addEventListener("touchcancel",V),document.addEventListener("mousemove",G),document.addEventListener("mouseup",V),g=W(),U=!0}},G=function(e){if(U){e.preventDefault();var t,n,o,i,a,l,c=e.changedTouches;c&&(e=c[0]),t=e.pageX,n=e.pageY,o=t-C,i=n-h,i<2&&i>-2&&(i=0),o<2&&o>-2&&(o=0),r||(o=0),s||(i=0),a=d+o,l=b+i,u&&(a<-(u[u.length-1]+186)+186*Math.floor((window.innerWidth-60)/186)&&(a=-(u[u.length-1]+186)+186*Math.floor((window.innerWidth-60)/186)),a>u[0]&&(a=u[0])),M===a&&p===l||(M=a,p=l,x||(x=!0)),P.push(t<y?1:0),y=t,E=n,S=requestAnimationFrame(X)}},K=function(){if(R&&(R=C-y)<4&&R>-4)return void(x=!1);if(M<1e-6&&M>-1e-6&&(M=0),p<1e-6&&p>-1e-6&&(p=0),s&&(o.style.top=p+"px"),r){l.dispatch(l.CAROUSEL_DRAGGED);var e=z()?8:0;t.hasClass(T,"gcp_nextItemPanelClosed")&&(o.style.left=M+e*F+"px")}J()},V=function(e){cancelAnimationFrame(S);var t;if(o.removeEventListener("touchend",V),o.removeEventListener("touchmove",G),o.removeEventListener("touchcancel",V),document.removeEventListener("mousemove",G),document.removeEventListener("mouseup",V),e&&(t=e.changedTouches,t&&(e=t[0]),e.pageX,e.pageY),x&&(f=W(),x=!1,u)){var n,i=-1,a=[];for(n=0;n<u.length;n++)a.push(u[n]+M);if(!0===Q(P)){for(n=a.length-1;n>-1;n--)if(a[n]<=-8){i=n;break}-1==i&&(i=0)}else for(n=0;n<a.length;n++)if(a[n]>=-16){i=n;break}F=i,_=-u[i],v=0,m=requestAnimationFrame(q)}U=!1,setTimeout(function(){l.dispatch(l.CAROUSEL_REQUIRES_UPDATED_ARIA)},600)},X=function(){R=!0,K()},q=function(){var e=M,t=.1*(_-e),n=e+t,o=!0;Math.abs(t)<1&&(o=!1,n=_),M=n,K(),o?m=requestAnimationFrame(q):cancelAnimationFrame(m)},J=function(){var e=t.hasClass(T,"helper_carouselFadedIn");if(j()?(t.addRemoveCSSclassToElement(w,"","gcp_inactive"),e&&(w.tabIndex="",O.tabIndex="")):(t.addRemoveCSSclassToElement(w,"gcp_inactive"),w.tabIndex=-1,w.style.fill="",w.style.backgroundColor=""),z()){t.addRemoveCSSclassToElement(A,"","gcp_inactive"),e&&(A.tabIndex=""),t.addRemoveCSSclassToElement(L,"gcp_LeftGradientfadedOut","gcp_LeftGradientfadedIn");t.hasClass(T,"gcp_nextItemPanelClosed")?t.addRemoveCSSclassToElement(T,"","helper_leftGradientFadedIn"):t.addRemoveCSSclassToElement(T,"helper_leftGradientFadedIn","")}else t.addRemoveCSSclassToElement(A,"gcp_inactive"),A.tabIndex=-1,A.style.fill="",A.style.backgroundColor="",t.addRemoveCSSclassToElement(L,"gcp_LeftGradientfadedIn","gcp_LeftGradientfadedOut"),t.addRemoveCSSclassToElement(T,"helper_leftGradientFadedIn","")},j=function(){var e=n.viewModel.nextItemPanelWidth,o=t.hasClass(T,"gcp_nextItemPanelClosed"),i=o?186:0,a=o?M:0;return u[u.length-1]+i+a>window.innerWidth-e},z=function(){return isNaN(M)&&(M=-186),M<0},Q=function(e){for(var t=e.length<5?0:e.length-5,n=0,o=e.length-1;o>t;o--)0===e[o]&&n++;return n>3},$=function(){R=!1,a.HAS_FOCUS_BUG||A.focus(),t.hasClass(A,"gcp_inactive")||(F-=Math.floor((window.innerWidth-60)/186),ne(F)),J(),setTimeout(function(){l.dispatch(l.CAROUSEL_REQUIRES_UPDATED_ARIA)},600)},Z=function(){if(R=!1,a.HAS_FOCUS_BUG||w.focus(),!t.hasClass(w,"gcp_inactive")){F+=Math.floor((window.innerWidth-60)/186);var e=!t.hasClass(T,"gcp_nextItemPanelClosed");ne(e?0:F)}J(),setTimeout(function(){l.dispatch(l.CAROUSEL_REQUIRES_UPDATED_ARIA)},600)},ee=function(e){e.shiftKey&&9==e.keyCode&&!a.HAS_FOCUS_BUG&&(k=!0)},te=function(){if(k){var e=o.getElementsByTagName("button")[0];e&&(e.focus(),k=!1)}},ne=function(e){e=Math.max(Math.min(u.length-1,e),0),F=e,_=-u[e],_<-(u[u.length-1]+186)+186*Math.floor((window.innerWidth-60)/186)&&(_=-(u[u.length-1]+186)+186*Math.floor((window.innerWidth-60)/186),F=u.length-1-(Math.floor((window.innerWidth-60)/186)-1)),_>u[0]&&(_=u[0],F=0),q()},oe=function(e){t.hasClass(this,"gcp_inactive")||(this.style.fill=n.viewModel.foreHighlightColour,this.style.backgroundColor=n.viewModel.highlightColour)},ie=function(e){t.hasClass(this,"gcp_inactive")||(this.style.fill="",this.style.backgroundColor="")},ae=function(){this.style.fill=n.viewModel.highlightColour},le=function(){this.style.fill=""},se=function(){l.dispatch(l.CLOSE_BUTTON_CLICKED)};this.init=function(t,n,a,l,d,b){o=t,I=n,T=l,L=b,L.firstChild.textContent=d.autoPlugUpNextStopped,I.innerHTML=e.carouselControls.render({closeButtonAccessibilityLabel:d.autoPlugCloseCountdownAccessibilityText,nextButtonAccessibilityLabel:d.autoPlugRightChevron,previousButtonAccessibilityLabel:d.autoPlugLeftChevron}),N=document.getElementsByClassName("gcp_item"),A=I.getElementsByClassName("gcp_carouselControlsPrevious")[0],i.add(A,$,oe,ie),A.addEventListener("keydown",ee),A.addEventListener("blur",te),w=I.getElementsByClassName("gcp_carouselControlsNext")[0],O=T.getElementsByClassName("gcp_panelsClose")[0],i.add(w,Z,oe,ie),i.add(O,se,ae,le),s=void 0===a.moveOnYaxis||a.moveOnYaxis,r=void 0===a.moveOnXaxis||a.moveOnXaxis,u=a.xTargets,c=a.yTargets,u&&u.length&&J(),o.style.position="absolute",o.addEventListener("mousedown",Y),o.addEventListener("touchstart",Y),o.addEventListener("click",B,!0),o.addEventListener("keydown",H),o.ondragstart=o.onselectstart=function(){return!1}},this.setPosition=function(e){I&&(I.style.top="useBottom"!==e?e+"px":"")},this.update=function(e){s=void 0===e.moveOnYaxis||e.moveOnYaxis,r=void 0===e.moveOnXaxis||e.moveOnXaxis,u=e.xTargets,c=e.yTargets,u&&u.length&&J()},this.positionAtIndex=function(e){ne(e)},this.animateToIndex=function(e){ne(e)},this.updateScrollButtons=function(){J()},this.canScrollForward=function(e){return j()},this.resetX=function(){M=0}}}),define("carousel/carousel",["carousel/DraggableDiv","model/cpModel","model/copy","model/templates","utils/eventbus","utils/cssTools","utils/playlistTools","model/config"],function(e,t,n,o,i,a,l,s){"use strict";var r,u,c,d,b,f,g,p,m,_,v,C,h,y,E,P,S=[],I=!1,A=!1,w=!1,T=!1,L=function(t,o){r=t.container,u=o,c=t.background,f=t.controls,C=n.translations,d=c.getElementsByClassName("gcp_carouselBackgroundLeftGradient")[0],c.firstChild.textContent=C.autoPlugMoreContents,b=new e,b.init(r,f,{moveOnYaxis:!1},u,C,d),g=f.getElementsByClassName("gcp_carouselControlsPrevious")[0],p=f.getElementsByClassName("gcp_carouselControlsNext")[0],m=f.getElementsByClassName("gcp_panelsClose")[0],D(),R(),w=!0,F()},O=function(e){r&&("useBottom"!==e?(r.style.top=e+"px",c.style.top=e+"px",b.setPosition(e)):(r.style.top="",c.style.top="",r.style.bottom=0,c.style.bottom=0,b.setPosition("useBottom")))},D=function(){r.addEventListener("mousedown",function(e){E=-1}),r.addEventListener("touchstart",function(e){P={x:e.touches[0].pageX,y:e.touches[0].pageY},E=-1}),r.addEventListener("touchend",function(e){var t=Math.abs(e.changedTouches[0].pageX-P.x),n=Math.abs(e.changedTouches[0].pageY-P.y);t<10&&n<10&&(T=!0,setTimeout(function(){T&&N()},100))}),r.addEventListener("click",function(e){T=!1,N()}),r.addEventListener("keyup",function(e){if(t.viewModel.previousActiveElement&&"gcp_onDemandButtonContainer"===t.viewModel.previousActiveElement.id)return void(t.viewModel.previousActiveElement=null);if(w){var n=e.keyCode?e.keyCode:e.which;13!==n&&32!==n||N()}})},N=function(){if(-1!=E){var e=t.getItemAtIndex(E),n=e.playlist,o="string"==typeof n?n:l.getFirstProgrammeItem(n).vpid||l.getFirstProgrammeItem(n).versionID;t.loadedPlaylistURLorPID!=o&&i.dispatch(i.CAROUSEL_ITEM_CLICK,e)}},R=function(e){S=[],t.viewModel.buttonsArray=[],M();for(var n=t.getItems(),i=0;i<n.length;i++)!function(e,s){t.viewModel.windowWith=window.innerWidth;var c,d=l.mergeIntoPlaylist(e);d.holdingImageURL&&(c=window.Utils&&window.Utils.doChef?d.holdingImageURL=window.Utils.doChef(d.holdingImageURL,null,null,200):"");var f=document.createElement("li");f.className=e.live?"gcp_carouselItem gcp_live":"gcp_carouselItem";var g=l.setLiveOrDuration(e,d,C),p=l.getVoiceReadersDuration(g,C);f.innerHTML=o.carouselItem.render({buttonOrDiv:"div",role:'role = "button"',title:d.title,holdingImageURL:c,description:d.summary,date:d.date,duration:g,durationAriaLabel:p})
;var m=f.childNodes[0],P=m.getElementsByClassName("gcp_itemCtaIcon")[0],w=d.title+" "+p;w=C.autoPlugPlayItemNumber+" "+w,w=w.replace("{number}",i+1),w=w.replace("{total}",n.length),m.setAttribute("aria-label",w),m.setAttribute("title",d.title);var T=t.viewModel.windowWith>400?456:248;v=186*(n.length-1)+T<t.viewModel.windowWith,m.setAttribute("tabIndex","-1"),m.addEventListener("mouseup",function(e){E&&E!==s&&(E=-1),I=!1}),m.addEventListener("touchend",function(e){E=s,I=!1}),m.addEventListener("mousedown",function(e){E=s,I=!0}),m.addEventListener("keydown",function(e){var t=e.keyCode?e.keyCode:e.which;13!==t&&32!==t||(E=s,I=!0)}),m.addEventListener("touchstart",function(e){I=!0,A=!0,setTimeout(function(){A=!1},1e3)}),m.addEventListener("mouseover",function(e){A||(P.style.backgroundColor=t.viewModel.highlightColour,P.style.fill=t.viewModel.foreHighlightColour,m.style.backgroundColor="#404040")}),m.addEventListener("focus",function(e){A||(P.style.backgroundColor=t.viewModel.highlightColour,P.style.fill=t.viewModel.foreHighlightColour,m.style.backgroundColor="#404040")}),m.addEventListener("mouseout",function(e){A||(P.style.backgroundColor="#000000",P.style.fill="#ffffff",m.style.backgroundColor="")}),m.addEventListener("blur",function(e){A||(P.style.backgroundColor="#000000",P.style.fill="#ffffff",m.style.backgroundColor="")}),m.addEventListener("focus",function(e){var n=a.hasClass(u,"gcp_nextItemPanelClosed");if(!1===I&&n){if(S[s].getElementsByClassName("gcp_item")[0].getBoundingClientRect().left+t.viewModel.nextItemPanelWidth<=0){var o=s-Math.floor((t.viewModel.windowWith-60)/186)+1;b.animateToIndex(o)}y[s]+t.viewModel.nextItemPanelWidth>=t.viewModel.windowWith-60&&(b.animateToIndex(s),x()),W()}}),m.addEventListener("click",function(e){E=s}),f.style.marginRight="16px";var L=186*i;h.push(L),y=h,e.button=m,S.push(f),t.viewModel.buttonsArray.push(f),0!=i?r.appendChild(f):_=f}(n[i],i);var s=186*t.getItems().length+2e3;r.style.width=s+"px",b.update({moveOnYaxis:!1,xTargets:h}),e&&H(),1==n.length?a.addRemoveCSSclassToElement(u,"singleCarouselItem",""):a.addRemoveCSSclassToElement(u,"","singleCarouselItem")},M=function(){for(h=[];r.hasChildNodes();)r.removeChild(r.lastChild)},U=function(e,n){var o=a.hasClass(u,"gcp_nextItemPanelClosed");if(e&&k(0),H(),!w){a.fadeIn(r),a.fadeIn(c),a.fadeIn(f),g&&(g.setAttribute("tabIndex",""),g.setAttribute("aria-hidden","false")),p&&(p.setAttribute("tabIndex",""),p.setAttribute("aria-hidden","false")),m&&(m.setAttribute("tabIndex",""),m.setAttribute("aria-hidden","false"));for(var i=t.getItems(),l=0;l<i.length;l++){i[l].button.getBoundingClientRect().right<parseInt(u.style.width,10)&&o&&(i[l].button.setAttribute("tabIndex",""),i[l].button.setAttribute("aria-hidden","false"))}}if(v&&x(),w=!0,a.addRemoveCSSclassToElement(u,"helper_carouselFadedIn","helper_carouselFadedOut"),n){i[t.hasMoreItemsToPlay()?t.getCurrentlyPlayingItemIndex()+1:0].button.focus()}},x=function(){v=186*(S.length-1)+t.viewModel.nextItemPanelWidth<t.viewModel.windowWith;var e=a.hasClass(u,"gcp_nextItemPanelClosed");if(w&&e||v)for(var n=t.getItems(),o=0;o<n.length;o++){var i=n[o].button.getBoundingClientRect();i.left<t.viewModel.windowWith?(n[o].button.setAttribute("tabIndex","0"),n[o].button.setAttribute("aria-hidden","false")):(n[o].button.setAttribute("tabIndex","-1"),n[o].button.setAttribute("aria-hidden","true"))}},F=function(){if(w){a.fadeOut(r),a.fadeOut(c),a.fadeOut(f),g&&(g.setAttribute("tabIndex","-1"),g.setAttribute("aria-hidden","true")),p&&(p.setAttribute("tabIndex","-1"),p.setAttribute("aria-hidden","true")),m&&(m.setAttribute("tabIndex","-1"),m.setAttribute("aria-hidden","true"));var e=t.getItems();if(e)for(var n=0;n<e.length;n++)e[n].button.setAttribute("tabIndex","-1"),e[n].button.setAttribute("aria-hidden","true")}w=!1,t.viewModel.previousActiveElement=null,a.addRemoveCSSclassToElement(u,"helper_carouselFadedOut","helper_carouselFadedIn")},k=function(e){b&&b.positionAtIndex(e)},B=function(){return E},W=function(){b&&b.updateScrollButtons()},H=function(){s.CAROUSEL_UPDATED=!0,M();for(var e=t.getCurrentlyPlayingItemIndex()+1,n=0;n<S.length;n++)n!=e&&r.appendChild(S[n]);a.hasClass(u,"gcp_nextItemPanelClosed")&&S[e]&&("prepend"in Element.prototype?r.prepend(S[e]):r.insertBefore(S[e],r.childNodes[0])),setTimeout(function(){x()},500)};return{init:L,positionAtIndex:k,getClickedOnCarouselItemIndex:B,show:U,hide:F,createCarousel:R,updateScrollButtons:W,updateCarouselItemsList:H,reSetCarouselLeft:function(){r.style.left="",b.resetX()},updateAriaAndTabIndex:x,setPosition:O}}),define("carousel/onDemandCarouselButton",["utils/eventbus","utils/uiListener","model/cpModel","model/config","model/templates","model/copy"],function(e,t,n,o,i,a){"use strict";var l,s,r,u=function(t){var n=0===t.offsetX&&0===t.offsetY;e.dispatch(e.ON_DEMAND_CAROUSEL_BUTTON_CLICK,n)},c=function(){var e=n.viewModel.enhanceBrightColoursContrast?"#000000":"#fff";s.style.backgroundColor=n.viewModel.highlightColour,s.style.color=e},d=function(){s.style.backgroundColor="",s.style.color="#fff"};return{init:function(e){r=a.translations,l=e;var n;switch(o.OPEN_CAROUSEL_BUTTON_LABEL){case 1:n=r.autoPlugWatchMore;break;case 2:n=r.autoPlugMoreClips;break;case 3:n=r.autoPlugMoreProgrammes;break;case 4:n=r.autoPlugShowMore;break;case 5:n=r.autoPlugMoreContents;break;case 6:n=r.autoPlugMoreVideos;break;default:n=r.autoPlugWatchMore}l.innerHTML=i.onDemandButton.render({buttonText:n,accessibilityLabel:n}),s=e.firstChild,t.add(s,u,c,d)},setPosition:function(e,t){l&&(l.style.top=e-8+"px",l.style.right=t+"px")}}}),define("countdownItem/countdownItem",["model/cpModel","model/copy","model/templates","utils/eventbus","utils/cssTools","utils/uiListener","utils/playlistTools","utils/generalUtils","model/config"],function(e,t,n,o,i,a,l,s,r){"use strict";var u,c,d,b,f,g,p,m,_,v,C,h,y,E,P,S,I,A,w,T,L=!1,O=!1,D="",N=function(e,n){c=e,d=n,u=t.translations,M(),U(),window.addEventListener("keyup",x.bind(this))},R=function(e){c&&("useBottom"!==e?c.style.top=e+"px":(c.style.top="",c.style.bottom=0))},M=function(){b=document.createElement("div"),b.className="gcp_inpageCountdownHeader",g=document.createElement("div"),g.className="gcp_inpageCountdownItemContent backgroundFadedOut",c.appendChild(b),c.appendChild(g),y=document.createElement("div"),y.className="gcp_spinnerCountdown",y.id="gcp_spinnerCountdown",c.appendChild(y)},U=function(){a.add(g,W)},x=function(e){var t=e.keyCode?e.keyCode:e.which;e.ctrlKey&&81==t&&J()},F=function(){p&&(p.style.backgroundColor=e.viewModel.highlightColour)},k=function(){p&&(p.style.backgroundColor="transparent")},B=function(){var e=parseInt((Date.now()-w)/1e3);return o.dispatch(o.DISMISS_CP,e),j(),o.dispatch(o.DISMISS_CLICK_FROM_NEXT_ITEM_PANEL),!1},W=function(e){var t=parseInt((Date.now()-w)/1e3);return o.dispatch(o.COUNTDOWN_CLICK,t),j(),e.stopPropagation(),!1},H=function(){o.dispatch(o.COUNTDOWN_SKIPPED),J()},Y=function(){f&&(L=!0,f.style.color=e.viewModel.highlightColour)},G=function(){f&&(L=!1,f.style.color="#ffffff")},K=function(){f&&(L=!0,f.style.color=e.viewModel.highlightColour,i.addRemoveCSSclassToElement(h,"gcp_spinnerCountdown_button_focused"))},V=function(){f&&(L=!1,f.style.color="#ffffff",i.addRemoveCSSclassToElement(h,"","gcp_spinnerCountdown_button_focused"))},X=function(){P&&(m.style.fill=e.viewModel.highlightColour)},q=function(){P&&(m.style.fill="#FFFFFF")},J=function(){v.innerHTML=u.autoPlugUpNextStopped,i.addRemoveCSSclassToElement(d,"gcp_countdownStopped"),setTimeout(function(){i.addRemoveCSSclassToElement(d,"leftTransitionRemoved")},700),clearInterval(S),clearInterval(T),setTimeout(function(){te(),o.dispatch(o.CAROUSEL_REQUIRES_UPDATED_ARIA)},600),C.setAttribute("aria-label",u.autoPlugAccessibilityCountdownStopped),window.ScreenReader&&window.ScreenReader.alert(u.autoPlugAccessibilityCountdownStopped)},j=function(){clearInterval(S),clearInterval(T),Q(),e.viewModel.countdownRunning=!1,O=!1,te(!0),i.addRemoveCSSclassToElement(d,"gcp_nextItemPanelClosed"),i.addRemoveCSSclassToElement(d,"","gcp_countdownStopped"),i.addRemoveCSSclassToElement(d,"","nextItemPanelInitialised")},z=function(){if(!O){i.addRemoveCSSclassToElement(d,"","gcp_nextItemPanelClosed"),i.addRemoveCSSclassToElement(d,"","leftTransitionRemoved"),O=!0,A=I,e.viewModel.countdownRunning=!0;var t=u.autoPlugUpNext;Z(A,t,u.autoPlugCloseCountdownAccessibilityText),v=b.getElementsByClassName("gcp_countdownText")[0],_=y.getElementsByClassName("gcp_timer")[0],m=b.getElementsByClassName("gcp_closeSVG")[0],C=g.getElementsByClassName("gcp_item")[0],a.add(C,null,F,k),p=g.getElementsByClassName("gcp_itemCtaIcon")[0],a.add(p,null,F,k);var n=e.getNextPlayingItem(),l=n.playlist;if(l)var s=l.title+" ";""!=D&&D!=u.autoPlugLive?(s=s+" "+u.autoPlugDurationTime,s=s.replace("{time}",D)):D==u.autoPlugLive&&(s=s+" "+u.autoPlugLive);var r=e.getItems();s=u.autoPlugPlayItemNumber+" "+s,s=s.replace("{number}",1),s=s.replace("{total}",r.length);var c=g.childNodes[0];c.setAttribute("aria-label",s),c.setAttribute("title",s),S=window.setInterval(function(){if(!L){A--;var e="0"==A?"":A;if(_.innerHTML=e,A<=0)return j(),void o.dispatch(o.COUNTDOWN_COMPLETE)}},1e3);i.hasClass(d,"gcp_countdownStopped")&&i.addRemoveCSSclassToElement(d,"","gcp_countdownStopped"),o.dispatch(o.COUNTDOWN_STARTED),$()}},Q=function(){o.dispatch(o.SHOW_SMP_SCRUBBAR),C&&(C.setAttribute("tabIndex","-1"),C.setAttribute("aria-hidden","true"),r.IS_WIN7_IE11&&(C.style.display="none")),C&&C.blur(),E&&(E.setAttribute("tabIndex","-1"),E.setAttribute("aria-hidden","true")),i.fadeOut(c)},$=function(){e.viewModel.isFullscreen||o.dispatch(o.HIDE_SMP_SCRUBBAR),C&&(r.IS_WIN7_IE11&&(C.style.display="block"),C.setAttribute("tabIndex",""),C.setAttribute("aria-hidden","false")),E&&(E.setAttribute("tabIndex",""),E.setAttribute("aria-hidden","false")),i.fadeIn(c),setTimeout(function(){i.addRemoveCSSclassToElement(d,"nextItemPanelInitialised")},400)},Z=function(t,o,s){b.innerHTML=n.countdownItem.render({countdownText:o});var c=e.getNextPlayingItem(),p=l.mergeIntoPlaylist(c);D=l.setLiveOrDuration(c,p,u);var m,_=l.getVoiceReadersDuration(D,u);if(window.Utils&&p.holdingImageURL&&(m=window.Utils.doChef(p.holdingImageURL,null,null,200)),g.innerHTML=n.carouselItem.render({buttonOrDiv:"button",role:"",title:p.title,holdingImageURL:m,description:p.summary,date:p.date,duration:D,durationAriaLabel:_}),!m){var v=document.getElementsByClassName("gcp_itemImg")[0];v.style.width="163px",v.style.height="92px",v.style.backgroundColor="black"}te();var C=2*Math.PI*48,S=C+"px, "+C+"px",I="stroke-dasharray:"+S+'; stroke-dashoffset:-0px; transition:stroke-dashoffset 0.1s linear;"',O=p.title,N=r.IS_TOUCH?u.autoPlugAccessibilityLabelCountdownTouchDevice:u.autoPlugAccessibilityLabelCountdown,R=N.replace("{title}",O),M=u.autoPlugCancel;y.innerHTML=n.countdownSpinner.render({default_pathString:"M 50,50 m 0,-48 a 48,48 0 1 1 0,96 a 48,48 0 1 1 0,-96",fullCircleStrokeDasharray:S,pathStyle:I,seconds:t,strokeColour:e.viewModel.highlightColour,accessibilityLabelCountdown:R,cancel:M}),w=Date.now();var U=10*A,x=1,F=document.getElementsByClassName("gcp_circle_animation")[0];T=setInterval(function(){if(!L){if(x==U)return void clearInterval(T);var e=(x+1)*(C/U);F&&(F.style.strokeDashoffset=e),x++}},100),f=document.getElementsByClassName("gcp_cancel")[0],h=document.getElementsByClassName("gcp_spinnerCountdownWrap")[0],E=document.getElementsByClassName("gcp_spinnerCountdown_button")[0];var k=document.getElementsByClassName("gcp_timerX")[0];k&&(k.style.fill=e.viewModel.highlightColour),h&&a.add(h,H,Y,G),E&&a.add(E,null,K,V),r.IS_OLD_IPAD&&(i.addRemoveCSSclassToElement(y,"oldIpad",""),7===r.IOS_VERSION&&i.addRemoveCSSclassToElement(y,"oldIpadIos7","")),(P=d.getElementsByClassName("gcp_countdownClose")[0])&&a.add(P,B,X,q);var W=r.IS_IOS?500:0;window.ScreenReader&&setTimeout(function(){window.ScreenReader.alert(R)},W)},ee=function(e){(e>20||e<5)&&(e=10),I=Math.round(e)},te=function(t){b.offsetWidth&&(e.viewModel.nextItemPanelWidth=t?0:b.offsetWidth,o.dispatch(o.NEXT_ITEM_PANEL_WIDTH))};return{init:N,setCountdownDurationSecs:ee,startCountdown:z,stopCountdown:j,onDismissClick:B,dismissCountdown:H,setPosition:R}}),define("utils/cookiesHelper",["model/config"],function(e){"use strict";function t(){try{var e=RegExp("ckps_onwardJourney[^;]+").exec(document.cookie);return decodeURIComponent(e?e.toString().replace(/^[^=]+./,""):"")}catch(e){return""}}function n(){o();try{var n=document.cookie}catch(e){n=""}if(-1==n.indexOf("ckps_onwardJourney="))return null;var i=t("ckps_onwardJourney");try{i=JSON.parse(i)}catch(e){i={}}return""!=e.PRODUCT_NAME?!i.hasOwnProperty(e.PRODUCT_NAME)||i[e.PRODUCT_NAME].enabled:!i.hasOwnProperty("enabled")||i.enabled}function o(){try{var e=document.cookie}catch(t){e=""}var t=e.indexOf("ckps_onwardJourney=");if(-1==t)return null;t+=19;var n=t+1,o=e.substring(t,n);1==o?a(!0,!0):0==o&&a(!1,!0)}var i=function(){try{var e=document.cookie}catch(t){e=""}var t=e.indexOf("ckns_policy=")+12,n=t+3;if(-1==t)return!1;var o=e.substring(t,n);return!o||"0"!=o[1]},a=function(n,o){if(i()){var a=new Date;a.setTime(a.getTime()+15552e6),a.setDate(15),a.setHours(12),a.setMinutes(0),a.setSeconds(0);var l="; expires="+a.toGMTString(),s=location.hostname;-1!==s.indexOf(".bbc.co.uk")&&(s=".bbc.co.uk"),-1!==s.indexOf(".bbc.com")&&(s=".bbc.com");var r,u=t("ckps_onwardJourney");if(""==u||o)r={};else try{r=JSON.parse(u)}catch(e){r={}}var c;if(""!=e.PRODUCT_NAME){var d={};d.enabled=n,r[e.PRODUCT_NAME]=d,c=JSON.stringify(r)}else r.enabled=n,c=JSON.stringify(r);try{document.cookie="ckps_onwardJourney="+encodeURIComponent(c)+l+"; Domain="+s+"; Path=/"}catch(e){}}};return{setCookie:a,getCookie:n}}),define("controller",["utils/languageMappings","utils/eventbus","model/statsConstants","model/copy","model/templates","carousel/carousel","carousel/onDemandCarouselButton","countdownItem/countdownItem","utils/playlistTools","utils/cssTools","model/cpModel","model/config","utils/cookiesHelper"],function(e,t,n,o,i,a,l,s,r,u,c,d,b){"use strict";function f(e){switch(e.name){case"dfpAds.js":g()}}function g(){!1===d.AD_PLUGIN_EXISTS&&(d.AD_PLUGIN_EXISTS=!0,m.addEventListener("bbc.smp.plugins.ads.event.AdsPluginExternalEvent.ALL_ADS_COMPLETED",function(){q()}),C=!1)}var p,m,_,v,C,h,y=!1,E=!1,P=!1,S=!1,I=!0,A=!1,w=function(t){p=t,m=p.playerInterface,h="onwardJourneyPlugin",c.viewModel.highlightColour=m.settings.ui.colour,c.viewModel.foreHighlightColour=m.settings.ui.foreColour,c.viewModel.controlsAlwaysOriginalSetting=!(!m.settings.ui.controls||!m.settings.ui.controls.always),m.settings.ui.accessibility&&(c.viewModel.enhanceBrightColoursContrast=m.settings.ui.accessibility.enhanceBrightColoursContrast),m.addContextMenuItem&&m.addContextMenuItem("_onwardJourneyPluginIdHTML","OnwardJourneyPluginHTML.2.4.0"),M(),U(),x();for(var n=t.getPluginList(),o=0;o<n.length;o++)if("dfpAds.js"===n[o].name){g();break}var i,a=m.settings.ui.locale.lang;i=e.map(a),_="../css/"+i+".css",p.loadCSS(_,h)},T=function(e){e.path==_&&e.id==h&&(O(),N(),P=!0,R())},L=function(e){e.path==_&&e.id==h&&(v||(v=!0,_="../css/en.css",p.loadCSS(_,h)))},O=function(){var e=m.datastore.get(d.CONT_PLAY_DATA_KEY);if(e){var t={data:{name:d.CONT_PLAY_DATA_KEY,data:e}};H(t)}},D=function(){null==b.getCookie()?(d.CP_ENABLED=!0,m.settings={continuousPlay:!0}):0==b.getCookie()?(d.CP_ENABLED=!1,m.settings={continuousPlay:!1}):(d.CP_ENABLED=!0,m.settings={continuousPlay:!0})},N=function(){var e=document.createElement("div");e.className="svgHolder",e.innerHTML=i.icons.render({}),m.container.appendChild(e);var t=document.createElement("div");t.className="gcp_inpageCountdownItem fadedOut",t.style.pointerEvents="none",m.container.appendChild(t),s.init(t,m.container);var n=document.createElement("ul");n.className="gcp_carouselContainer fadedOut",m.container.appendChild(n);var o=document.createElement("div");o.className="gcp_carouselBackground fadedOut";var r=document.createElement("p");r.className="gcp_moreContentTitle";var u=document.createElement("div");u.className="gcp_carouselBackgroundLeftGradient fadedOut";var c=document.createElement("p");c.className="gcp_upNextTitle ",u.appendChild(c),o.appendChild(r),o.appendChild(u),m.container.appendChild(o);var d=document.createElement("div");d.className="gcp_carouselControls fadedOut",m.container.appendChild(d),a.init({container:n,background:o,controls:d},m.container);var b=document.createElement("div");b.className="gcp_onDemandButtonContainer",m.container.appendChild(b),l.init(b),A=!0},R=function(){var e=m.playlist;if(e){V({playlist:e})}},M=function(){var e=navigator.userAgent,t=/windows phone/i.test(e),n=/iPhone/i.test(e)&&!t,o=/iPod/i.test(e)&&!t,i=/iPad/i.test(e)&&!t,a=n||i||o,l=null,s=/Android/i.test(e)&&!t,r=/trident\/7/i.test(e),u=/windows NT 6\.1/i.test(e),c=r&&u,b=/windows/i.test(e);if(a){var f=e.match(/OS ([0-9]+)/);l=f?parseInt(f[1],10):0}d.IS_IPHONE_OR_IPOD=n||o,d.IS_IPHONE=n,d.HAS_FOCUS_BUG=a,d.IS_IOS=a,d.IOS_VERSION=l,d.IS_OLD_IPAD=l>0&&l<9&&i,d.IS_TOUCH=t||s||a,d.IS_WINDOWS=b,d.IS_WIN7_IE11=c},U=function(){t.addEventListener(t.CAROUSEL_ITEM_CLICK,oe),t.addEventListener(t.COUNTDOWN_COMPLETE,ie),t.addEventListener(t.DISMISS_CP,te),t.addEventListener(t.COUNTDOWN_CLICK,ne),t.addEventListener(t.SHOW_SMP_SCRUBBAR,se),t.addEventListener(t.HIDE_SMP_SCRUBBAR,re),t.addEventListener(t.COUNTDOWN_SKIPPED,ae),t.addEventListener(t.CAROUSEL_DRAGGED,ue),t.addEventListener(t.NEXT_ITEM_PANEL_WIDTH,ce),t.addEventListener(t.COUNTDOWN_STARTED,de),t.addEventListener(t.CLOSE_BUTTON_CLICKED,be),t.addEventListener(t.CAROUSEL_REQUIRES_UPDATED_ARIA,fe),t.addEventListener(t.ON_DEMAND_CAROUSEL_BUTTON_CLICK,ge),t.addEventListener(t.DISMISS_CLICK_FROM_NEXT_ITEM_PANEL,pe)},x=function(){m.listenerObject=function(e){return{setData:H,uiinfo:j,ended:k,playlistLoaded:V,playlistLoading:G,playing:B,adsPlugin:W,cssLoaded:T,cssLoadFailed:L,mediaItemChanged:F,continuousPlayChange:Q,continuousPlayToggleSwitched:$,controlsPanelOpened:Z,chromecastToggle:ee,pluginLoaded:f}}()},F=function(e){e&&(e.isLive,d.CP_ENABLED)},k=function(e){d.AD_PLUGIN_EXISTS&&!1===C?y=!0:(m.queuePlaylist({}),J())},B=function(){z(),E&&(E=!1,m.dispatchEvent({type:n.CP_PLAY,origin:n.CP_PLAY_VIDEO_REPLAY}),m.trackAction(n.AP_PLAY_VIDEO_REPLAY)),c.viewModel.countdownRunning&&(s.stopCountdown(),m.dispatchEvent({type:n.CP_PLAY,origin:n.CP_PLAY_VIDEO_REPLAY}),m.trackAction(n.AP_PLAY_VIDEO_REPLAY)),S=m.isFromIdent,c.viewModel.onDemandCarouselShown=!1,m.updateUiConfig({controls:{always:c.viewModel.controlsAlwaysOriginalSetting}},!0),a.hide()},W=function(e){"adStarted"===e.id&&(c.viewModel.showingAds=!0),"adEnded"===e.id&&(c.viewModel.showingAds=!1)},H=function(e){if(e.data.name==d.CONT_PLAY_DATA_KEY){var t=e.data.data;if(t.continuousPlayName){var n=t.continuousPlayName.match(/([a-z0-9_])+/g);n&&(d.PRODUCT_NAME=n.join(""))}t.fullscreenOnlyCarousel?(d.FULLSCREEN_ONLY_CAROUSEL=t.fullscreenOnlyCarousel,u.addRemoveCSSclassToElement(m.container,"gcp_fullscreenOnlyCarousel","gcp_carouselOnDemandAlways")):t.alwaysShowCarouselButton&&u.addRemoveCSSclassToElement(m.container,"gcp_carouselOnDemandAlways","gcp_fullscreenOnlyCarousel"),t.openCarouselButtonLabel&&"number"==typeof t.openCarouselButtonLabel&&t.openCarouselButtonLabel<=6&&t.openCarouselButtonLabel>0&&(d.OPEN_CAROUSEL_BUTTON_LABEL=t.openCarouselButtonLabel),!1===t.showDate?u.addRemoveCSSclassToElement(m.container,"gcp_noDate",""):u.addRemoveCSSclassToElement(m.container,"","gcp_noDate");var i=d.IS_WINDOWS?1e3:0;setTimeout(function(){D()},i);var l=r.validateTheData(t,m.container);c.setItems(l),m.updateUiConfig({controls:{availableOnMediaEnded:!0},chromecast:{shiftCentralControls:!0}}),s.setCountdownDurationSecs(t.countdownDurationSecs||d.DEFAULT_COUNTDOWN_SECS),o.update(),"true"!==t.pretendPlaylistHasAds&&!0!==t.pretendPlaylistHasAds||(d.PRETEND_PLAYLIST_HAS_ADS=!0),!0!==t.stopAutoplayOnGuidance&&!1!==t.stopAutoplayOnGuidance||(d.STOP_ON_GUIDANCE=t.stopAutoplayOnGuidance),!0===P&&a.createCarousel(!0),Y()}},Y=function(){var e=c.getItems(),t=c.getLoadedPlaylistURLorPID();if(e&&e.length>0&&""!==t){var n=r.checkForLoadedPlaylistURLorPIDinData(t,e);-1!=n?(c.setCurrentlyPlayingIndex(n),a.positionAtIndex(n)):c.setCurrentlyPlayingIndex(-1)}},G=function(e){K(),c.resetForNewPlaylist(),C=!1,a.hide()},K=function(){c.viewModel.countdownRunning&&s.stopCountdown(),E=!1,y=!1},V=function(e){if(c.getURLorPID(e.playlist)!==c.getLoadedPlaylistURLorPID()&&P){c.viewModel.playlistLoading=!1;var t=e.playlist;c.setLoadedPlaylist(t),Y(),X(t)}},X=function(e){!1!==e.hasAds||d.PRETEND_PLAYLIST_HAS_ADS||q()},q=function(){C=!0,c.viewModel.showingAds=!1,!0===y&&(y=!1,J())},J=function(){if(!c.viewModel.tooSmallForContinuousPlay&&!S&&!c.viewModel.onDemandCarouselShown)if(d.CP_ENABLED){var e=d.IS_OLD_IPAD?700:0;setTimeout(function(){c.hasMoreItemsToPlay()&&(s.startCountdown(),setTimeout(function(){var e=c.getNextPlayingItem(),t={};t.options={},e.counterName&&(t.options.counterName=e.counterName),e.statsObject&&(t.options.statsObject=e.statsObject),t.options.autoplay=!1!==e.autoplay,t.options.fromOnwardJourney=!0,t.playlist=e.playlist,m.queuePlaylist(t)},500)),a.show(!c.hasMoreItemsToPlay()),I=!0},e)}else a.show(!0)},j=function(e){e.videoWidth!=c.viewModel.videoWidth&&(c.viewModel.videoWidth=e.videoWidth,c.viewModel.tooSmallForContinuousPlay=e.videoWidth<320,a.updateScrollButtons()),e.isFullscreen!=c.viewModel.isFullscreen&&(c.viewModel.isFullscreen=e.isFullscreen),e.isFullscreen?u.addRemoveCSSclassToElement(m.container,"gcp_fullscreen",""):u.addRemoveCSSclassToElement(m.container,"","gcp_fullscreen"),c.viewModel.tooSmallForContinuousPlay&&c.viewModel.countdownRunning&&(s.stopCountdown(),a.hide());var t=0;if(t=e.isFullscreen?window.innerWidth:e.videoWidth,A){var n=e.controlsTop-88,o=e.seekBarLeft;l.setPosition(n,o);var i=t>=750?e.controlsTop-226-44:"useBottom";s.setPosition(i),a.setPosition(i)}z()},z=function(){c.viewModel.tooSmallForContinuousPlay?m.updateUiConfig({playbackSettingsPanel:{enabled:!1,continuousPlaySetting:!1}}):m.updateUiConfig({playbackSettingsPanel:{enabled:!0,continuousPlaySetting:!0}})},Q=function(e){d.CP_ENABLED!=e.status&&(d.CP_ENABLED=e.status,b.setCookie(e.status))},$=function(e){m.dispatchEvent({type:n.CP_STATS,id:e.status?n.CP_STATS_TURN_CP_ON:n.CP_STATS_TURN_CP_OFF}),m.trackAction(e.status?n.AP_STATS_TURN_AP_ON:n.AP_STATS_TURN_AP_OFF)},Z=function(){c.viewModel.countdownRunning&&s.dismissCountdown()},ee=function(){c.viewModel.countdownRunning&&s.dismissCountdown()},te=function(e){m.dispatchEvent({type:n.CP_STATS,id:n.CP_STATS_DISMISS_CONT_PLAY,secondsIntoCountdown:e}),m.trackAction(n.AP_STATS_DISMISS_CONT_PLAY),E=!0,m.queuePlaylist({})},ne=function(e){m.dispatchEvent({type:n.CP_PLAY,origin:n.CP_PLAY_VIDEO_COUNTDOWN_CLICKED,fullscreen:c.viewModel.isFullscreen,index:c.getCurrentlyPlayingItemIndex()+1,secondsIntoCountdown:e}),m.trackAction(n.AP_PLAY_VIDEO_COUNTDOWN_CLICKED,null,{secondsIntoCountdown:e}),d.STOP_ON_GUIDANCE&&m.playlist.queuedPlaylist.guidance?(m.stop(),m.next(!1)):m.next(!0)},oe=function(e){m.dispatchEvent({type:n.CP_PLAY,origin:n.CP_PLAY_VIDEO_CAROUSEL_CLICKED,fullscreen:c.viewModel.isFullscreen,index:a.getClickedOnCarouselItemIndex()}),m.trackAction(n.AP_PLAY_VIDEO_CAROUSEL_CLICKED),le(e)},ie=function(){m.dispatchEvent({type:n.CP_PLAY,origin:n.CP_PLAY_VIDEO_COUNTDOWN_COMPLETE,fullscreen:c.viewModel.isFullscreen,index:c.getCurrentlyPlayingItemIndex()+1}),m.trackAction(n.AP_PLAY_VIDEO_COUNTDOWN_COMPLETE),d.STOP_ON_GUIDANCE&&m.playlist.queuedPlaylist.guidance||m.playlist.queuedOptions&&!1===m.playlist.queuedOptions.autoplay?(m.stop(),m.next(!1)):m.next(!0)},ae=function(){m.trackAction(n.AP_STATS_COUNTDOWN_SKIPPED)},le=function(e){if(e){var t={};t.autoplay=!0,d.STOP_ON_GUIDANCE&&e.playlist.guidance&&(t.autoplay=!1),e.counterName&&(t.counterName=e.counterName),e.statsObject&&(t.statsObject=e.statsObject),m.loadPlaylist(e.playlist,t)}},se=function(){m.updateUiConfig({controls:{mode:"default"}})},re=function(){c.viewModel.countdownRunning||m.updateUiConfig({controls:{mode:"controls"}})},ue=function(){I&&(I=!1,s.stopCountdown(),a.updateCarouselItemsList())},ce=function(){a.updateScrollButtons()},de=function(){a.reSetCarouselLeft()},be=function(){c.viewModel.onDemandCarouselShown=!1,m.updateUiConfig({controls:{always:c.viewModel.controlsAlwaysOriginalSetting}}),s.onDismissClick(),a.hide()},fe=function(){a.updateAriaAndTabIndex()},ge=function(e){c.viewModel.onDemandCarouselShown=!0,m.updateUiConfig({controls:{always:!0}}),c.viewModel.previousActiveElement=document.activeElement,a.show(!0,e),m.trackAction(n.AP_ON_DEMAND_CAROUSEL_BUTTON_CLICK,null,{fullscreen:c.viewModel.isFullscreen})},pe=function(){a.hide(),m.trackAction(n.AP_DISMISS_CLICK_FROM_NEXT_ITEM_PANEL)};return{init:w}});var runPlugin=function(e,t){return e.register({name:"onwardJourney.js"}),{pluginInitialisation:function(e){require(["controller"],function(t){t.init(e)})}}};define("plugin",function(){});